<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Cyy&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/f6fa6b7111bfc34aad52685714e4bf3b</icon>
  <subtitle>生命不止，折腾不息！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.cuiyy.top/"/>
  <updated>2017-10-13T03:40:10.866Z</updated>
  <id>http://blog.cuiyy.top/</id>
  
  <author>
    <name>CYY</name>
    <email>cyy6543@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>MongoDB开启权限验证的方法</title>
    <link href="http://blog.cuiyy.top/2017/10/13/O74WjrqshGRNERf1/"/>
    <id>http://blog.cuiyy.top/2017/10/13/O74WjrqshGRNERf1/</id>
    <published>2017-10-13T03:40:10.000Z</published>
    <updated>2017-10-13T03:40:10.866Z</updated>
    
    <content type="html"><![CDATA[<p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws2.sinaimg.cn/large/006tKfTcly1fkggtqchopj30e80e8t8z.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure></p><h2 id="基本角色"><a href="#基本角色" class="headerlink" title="基本角色"></a>基本角色</h2><ul><li><code>root</code>  这是超级管理员</li><li><code>userAdminAnyDatabase</code> 这个角色拥有分配角色和用户的权限，但没有查写的权限</li><li><code>readWrite</code>  有读写权限</li><li><code>read</code>    有读权限</li></ul><h2 id="创建一个超级用户"><a href="#创建一个超级用户" class="headerlink" title="创建一个超级用户"></a>创建一个超级用户</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">use admin</div><div class="line">db.createUser(&#123;</div><div class="line">    user: <span class="string">"root"</span>,</div><div class="line">    pwd: <span class="string">"cyy_mongo"</span>,</div><div class="line">    roles: [&#123;</div><div class="line">      <span class="string">"role"</span> : <span class="string">"root"</span>,</div><div class="line">      <span class="string">"db"</span> : <span class="string">"admin"</span> </div><div class="line">    &#125;]</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>db是指定数据库的名字，admin是管理数据库。</p><h2 id="开启认证"><a href="#开启认证" class="headerlink" title="开启认证"></a>开启认证</h2><p>进入<code>mongod.conf</code>配置文件，将<code>auth</code> 改为<code>true</code>；<br>重启<code>mongo</code>服务；</p><h2 id="权限登录"><a href="#权限登录" class="headerlink" title="权限登录"></a>权限登录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mongo --host xxx -u adminUserName -p userPassword --authenticationDatabase admin</div></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="查看当前用户的权限"><a href="#查看当前用户的权限" class="headerlink" title="查看当前用户的权限"></a>查看当前用户的权限</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">db.runCommand(&#123;</div><div class="line">    usersInfo:<span class="string">"userName"</span>,</div><div class="line">    showPrivileges:<span class="literal">true</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><h3 id="创建一般用户，也是用createUser"><a href="#创建一般用户，也是用createUser" class="headerlink" title="创建一般用户，也是用createUser"></a>创建一般用户，也是用createUser</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">db.createUser(&#123;</div><div class="line">    user:<span class="string">"user1"</span>,</div><div class="line">    pwd:<span class="string">"12345"</span>,</div><div class="line">    roles:[</div><div class="line">      &#123;<span class="attr">role</span>:<span class="string">"read"</span>,<span class="attr">db</span>:<span class="string">"db1"</span>&#125;,</div><div class="line">      &#123;<span class="attr">role</span>:<span class="string">"read"</span>,<span class="attr">db</span>:<span class="string">"db2"</span>&#125;,</div><div class="line">      &#123;<span class="attr">role</span>:<span class="string">"read"</span>,<span class="attr">db</span>:<span class="string">"db3"</span>&#125;</div><div class="line">    ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure><h3 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">use admin</div><div class="line">db.changeUserPassword(<span class="string">"username"</span>, <span class="string">"xxx"</span>)</div></pre></td></tr></table></figure><h3 id="查看用户信息"><a href="#查看用户信息" class="headerlink" title="查看用户信息"></a>查看用户信息</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">db.runCommand(&#123;<span class="attr">usersInfo</span>:<span class="string">"userName"</span>&#125;)</div></pre></td></tr></table></figure><h3 id="修改密码和用户信息"><a href="#修改密码和用户信息" class="headerlink" title="修改密码和用户信息"></a>修改密码和用户信息</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">db.runCommand(&#123;</div><div class="line">    updateUser:<span class="string">"username"</span>,</div><div class="line">    pwd:<span class="string">"xxx"</span>,</div><div class="line">    customData:&#123;<span class="attr">title</span>:<span class="string">"xxx"</span>&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure><div style="text-align:right;font-size:12px;color:#666;">—-publish by <a href="http://ceditor.alibt.top" target="_blank">CEditor</a></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;figure class=&quot;image-bubble&quot;&gt; &lt;div class=&quot;img-lightbox&quot;&gt; &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt; &lt;img src=&quot;https://ws2.sinaimg.cn/large/006tKfTcly1fk
      
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="mongodb" scheme="http://blog.cuiyy.top/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>为了遇见你</title>
    <link href="http://blog.cuiyy.top/2017/10/12/dVIMLDDUxriU57uW/"/>
    <id>http://blog.cuiyy.top/2017/10/12/dVIMLDDUxriU57uW/</id>
    <published>2017-10-12T07:17:52.000Z</published>
    <updated>2017-10-12T07:17:52.503Z</updated>
    
    <content type="html"><![CDATA[<div style="text-align:center;"><br><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33071053&auto=1&height=66"></iframe><br></div><p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws2.sinaimg.cn/large/006tNbRwly1fkfheutp8jj30sg0lcjww.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure></p><div style="text-align:right;font-size:12px;color:#666;">—-publish by <a href="http://ceditor.alibt.top" target="_blank">CEditor</a></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div style=&quot;text-align:center;&quot;&gt;&lt;br&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//musi
      
    
    </summary>
    
      <category term="默认分类" scheme="http://blog.cuiyy.top/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term="其他" scheme="http://blog.cuiyy.top/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title>前端工程师都mac系统重装之后</title>
    <link href="http://blog.cuiyy.top/2017/10/11/etb9IVimFgncBxLQ/"/>
    <id>http://blog.cuiyy.top/2017/10/11/etb9IVimFgncBxLQ/</id>
    <published>2017-10-11T03:29:10.000Z</published>
    <updated>2017-10-11T03:29:10.060Z</updated>
    
    <content type="html"><![CDATA[<figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws1.sinaimg.cn/large/006tNc79ly1fke3s9cr5qj30c00aa755.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>最近刚更新了 macOS High Sierra，更新过程非常坎坷，最后终于安装成功了，但是曾经装的软件什么的都没有了，需要重新安装，这里列出我所安装的软件列表：</p><h3 id="系统常用"><a href="#系统常用" class="headerlink" title="系统常用"></a>系统常用</h3><ul><li>chrome浏览器</li><li><a href="https://srf.baidu.com/input/mac.html" target="_blank" rel="external">百度输入法</a></li><li>Magnet 分屏软件</li><li>iPic 图片上传神器</li><li>全能解压</li><li>Alfred</li><li><a href="http://sipapp.io/" target="_blank" rel="external">Sip 拾色工具</a></li><li>1Password</li></ul><h3 id="社交"><a href="#社交" class="headerlink" title="社交"></a>社交</h3><ul><li><a href="http://weixin.qq.com/" target="_blank" rel="external">微信</a></li><li><a href="http://im.qq.com/macqq/" target="_blank" rel="external">qq</a></li><li><a href="https://im.dingtalk.com/" target="_blank" rel="external">钉钉</a></li></ul><h3 id="写作笔记"><a href="#写作笔记" class="headerlink" title="写作笔记"></a>写作笔记</h3><ul><li><a href="http://note.youdao.com/" target="_blank" rel="external">有道云笔记</a></li><li><a href="https://www.yinxiang.com/" target="_blank" rel="external">印象笔记</a></li></ul><h3 id="编辑器"><a href="#编辑器" class="headerlink" title="编辑器"></a>编辑器</h3><ul><li><a href="http://www.sublimetext.com/" target="_blank" rel="external">Sublime Text 3</a> (<a href="https://packagecontrol.io/installation" target="_blank" rel="external">package control</a>)</li><li><a href="https://code.visualstudio.com/" target="_blank" rel="external">VScode</a></li></ul><h3 id="Shell增强"><a href="#Shell增强" class="headerlink" title="Shell增强"></a>Shell增强</h3><ul><li><a href="http://ohmyz.sh/" target="_blank" rel="external">oh my zsh</a></li><li><a href="https://brew.sh/" target="_blank" rel="external">Homebrew</a></li><li>wget (brew install wget)</li><li>autojump (brew install autojump)<br>如果link失败可执行</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chown -R $(whoami) /usr/local/share/</div></pre></td></tr></table></figure><h3 id="代码管理"><a href="#代码管理" class="headerlink" title="代码管理"></a>代码管理</h3><ul><li><a href="https://git-scm.com/" target="_blank" rel="external">Git</a><br>生成KEY：<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git config --global user.name “xx”</div><div class="line">git config --global user.email “x@gmail.com"</div><div class="line">ssh-keygen -t rsa -C “xx@gmail.com”</div></pre></td></tr></table></figure></li></ul><h3 id="开发相关"><a href="#开发相关" class="headerlink" title="开发相关"></a>开发相关</h3><ul><li><a href="https://nodejs.org/en/download/" target="_blank" rel="external">Nodejs</a></li><li>nodemon (npm install -g nodemon) node更改自动重启</li><li><a href="https://yarnpkg.com/zh-Hans/" target="_blank" rel="external">yarn</a> （node包管理）</li><li><a href="https://npm.taobao.org/" target="_blank" rel="external">cnpm</a> 淘宝 NPM 镜像</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</div></pre></td></tr></table></figure><ul><li><a href="https://www.mongodb.com/" target="_blank" rel="external">Mongodb</a></li><li><a href="https://www.mysql.com/" target="_blank" rel="external">MySQL</a></li><li><a href="https://robomongo.org/" target="_blank" rel="external">Robo 3T</a> mongo客户端 </li><li><a href="http://www.navicat.com.cn" target="_blank" rel="external">Navicat for mysql</a> MySQL客户端</li><li><a href="http://www.redis.cn/" target="_blank" rel="external">Redis</a></li><li><a href="https://github.com/uglide/RedisDesktopManager/releases" target="_blank" rel="external">RedisDesktopManager</a> Redis客户端</li><li><a href="http://memcached.org/" target="_blank" rel="external">Memcached</a> 缓存管理</li></ul><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul><li><a href="https://www.sass.hk/" target="_blank" rel="external">Scss</a> 前端CSS扩展语言</li><li>vim 设置<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">vim ~/.zshrc</div><div class="line">syntax on</div><div class="line">set nu # 显示行号</div></pre></td></tr></table></figure></li></ul><hr><div style="text-align:right;font-size:12px;color:#666;">—-publish by <a href="http://ceditor.alibt.top" target="_blank">CEditor</a></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;image-bubble&quot;&gt; &lt;div class=&quot;img-lightbox&quot;&gt; &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt; &lt;img src=&quot;https://ws1.sinaimg.cn/large/006tNc79ly1fke3s
      
    
    </summary>
    
      <category term="默认分类" scheme="http://blog.cuiyy.top/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
      <category term=" 工具" scheme="http://blog.cuiyy.top/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>ssh 免密码登录</title>
    <link href="http://blog.cuiyy.top/2017/10/10/Ja5aO9RFlMdvjYBE/"/>
    <id>http://blog.cuiyy.top/2017/10/10/Ja5aO9RFlMdvjYBE/</id>
    <published>2017-10-10T05:00:31.000Z</published>
    <updated>2017-10-11T03:28:13.395Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>开发过程中，经常需要使用ssh登录远程主机，每次都要输入密码，影响效率，这里讲解一下，怎么使用ssh无密码登录。</p></blockquote><a id="more"></a><h3 id="本机生成ssh-key"><a href="#本机生成ssh-key" class="headerlink" title="本机生成ssh key"></a>本机生成ssh key</h3><p>ssh 无密码登录要使用公钥与私钥。linux下可以用用<code>ssh-keygen</code>生成公钥/私钥对。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -C "xxx@email.com"</div></pre></td></tr></table></figure><p>然后一路回车即可。</p><p>然后可以通过以下命令查看到生成的公钥：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cat ~/.ssh/id_rsa.pub</div></pre></td></tr></table></figure><h3 id="远程主机生成ssh-key"><a href="#远程主机生成ssh-key" class="headerlink" title="远程主机生成ssh key"></a>远程主机生成ssh key</h3><p>先通过<code>ssh</code>登录到远程主机， 并以同样的方式生成<code>ssh key</code></p><h3 id="复制本机公钥到远程文件"><a href="#复制本机公钥到远程文件" class="headerlink" title="复制本机公钥到远程文件"></a>复制本机公钥到远程文件</h3><p>把本地的<code>id_rsa.pub</code>文件中的内容复制到远程主机的<code>.ssh/authorized_keys</code>文件里.</p><p><code>authorized_keys</code>文件如果没有，可以自己手动创建。</p><p>添加完成后，退出重新使用<code>ssh</code> 登录时，就不需要输入密码了。</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;开发过程中，经常需要使用ssh登录远程主机，每次都要输入密码，影响效率，这里讲解一下，怎么使用ssh无密码登录。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="ssh" scheme="http://blog.cuiyy.top/tags/ssh/"/>
    
  </entry>
  
  <entry>
    <title>nodejs使用socket.io实现分布式一对一发送消息</title>
    <link href="http://blog.cuiyy.top/2017/09/27/QkkxF6N8eMj7mVKX/"/>
    <id>http://blog.cuiyy.top/2017/09/27/QkkxF6N8eMj7mVKX/</id>
    <published>2017-09-27T09:13:53.000Z</published>
    <updated>2017-10-11T02:05:34.485Z</updated>
    
    <content type="html"><![CDATA[<p>最近在用nodejs实现一个消息通知的功能，其中用到了socket.io；由于初次使用socket.io，在网上查找资料大都是聊天室广播的教程，没有找到一对一发送消息的具体实现方法，这里分享一下自己学习使用过程中踩到某些坑和最终实现方法。<br><a id="more"></a></p><blockquote><p>要实现的功能:<br>server端数据更新后，发送通知到对应客户端的用户；server是用nodejs写的，并使用了分布式，同时开启了多个实例。</p></blockquote><h3 id="一、安装依赖包"><a href="#一、安装依赖包" class="headerlink" title="一、安装依赖包"></a>一、安装依赖包</h3> <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install socket.io</div></pre></td></tr></table></figure><h3 id="二、socket-io的使用"><a href="#二、socket-io的使用" class="headerlink" title="二、socket.io的使用"></a>二、socket.io的使用</h3><p>1、index.js 文件内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.js</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'http'</span>).Server(app);</div><div class="line"><span class="keyword">var</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(server,&#123;</div><div class="line">    <span class="string">"path"</span>:<span class="string">"/notice"</span>  <span class="comment">//修改客户端请求的路径，默认为/socket.io</span></div><div class="line">&#125;);</div><div class="line"><span class="keyword">new</span> (<span class="built_in">require</span>(<span class="string">"./notice"</span>).init)(io); <span class="comment">//传入io</span></div></pre></td></tr></table></figure><p>2、notice.js文件内容</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Notice = <span class="literal">null</span>; </div><div class="line"><span class="keyword">var</span> socketMap  = &#123;&#125;; <span class="comment">//用户对应socket.id</span></div><div class="line"></div><div class="line"><span class="comment">//初始化socket连接</span></div><div class="line">exports.init = <span class="function"><span class="keyword">function</span> (<span class="params">io</span>)</span>&#123;</div><div class="line">    <span class="comment">//连接验证</span></div><div class="line">    io.use(<span class="function"><span class="keyword">function</span>(<span class="params">socket, next</span>)</span>&#123;</div><div class="line">        <span class="comment">//console.log(socket.request.headers.cookie);</span></div><div class="line">        <span class="keyword">var</span> token = socket.request._query.token || <span class="string">""</span>;</div><div class="line">        <span class="keyword">if</span>(validate(token))&#123;</div><div class="line">            socket.request.headers.user = &#123;<span class="attr">userId</span>:userId&#125;;</div><div class="line">            <span class="keyword">return</span> next();</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">return</span> next(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Authentication error'</span>));</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;);</div><div class="line">    Notice = io.of(<span class="string">"/notice"</span>).on(<span class="string">'connection'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">socket</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> user = socket.handshake.headers.user;</div><div class="line">        <span class="keyword">var</span> user_id = user &amp;&amp; user.userId;</div><div class="line">        <span class="keyword">if</span>(user_id)&#123;</div><div class="line">            socketMap[user_id] = socket.id;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        socket.on(<span class="string">'disconnect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">delete</span> socketMap[user_id];</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"><span class="comment">//其他模块调用，发送消息</span></div><div class="line">exports.send = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> user_id = data.accountID;</div><div class="line">    <span class="keyword">var</span> socket_id = socketMap[user_id];</div><div class="line">    Notice.to(socket_id).emit(<span class="string">'notice'</span>, data);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>3、客户端文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&lt;script src=<span class="string">"/socket.io/socket.io.js"</span>&gt;&lt;/script&gt;</div><div class="line">&lt;script&gt;</div><div class="line">  <span class="keyword">var</span> socket = io(<span class="string">'http://localhost?token=token'</span>);</div><div class="line">  socket.on(<span class="string">'notice'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(data);</div><div class="line">  &#125;);</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure><p>在跨域请求的情况下<code>socket.request.headers.cookie</code>是无法获取到有效的cookie的，所以这里直接从客户端传token过来进行验证。验证通过后，将用户信息存到headers中，客户端连接成功后，取出用户信息，并将用户id与此socket连接对应id存储到全局<code>socketMap</code>变量中，然后外部模块通过调用send方法来发送消息。</p><p>这种情况在单实例情况下是没有问题的，但是如果server开启了多个实例就出问题了。</p><h3 id="三、使用nginx实现分布式部署"><a href="#三、使用nginx实现分布式部署" class="headerlink" title="三、使用nginx实现分布式部署"></a>三、使用nginx实现分布式部署</h3><p>首先需要安装<a href="http://nginx.org/" target="_blank" rel="external">nginx</a>；安装完成后编写配置文件；</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">upstream</span> socket_test &#123;</div><div class="line">        ip_hash;</div><div class="line">        <span class="attribute">server</span> <span class="number">127.0.0.1:8013</span>;</div><div class="line">        <span class="attribute">server</span> <span class="number">127.0.0.1:8014</span>;</div><div class="line">&#125;</div><div class="line"><span class="section">server</span> &#123;</div><div class="line">    <span class="attribute">listen</span> <span class="number">80</span>;</div><div class="line">    <span class="attribute">server_name</span> socket.test.com;</div><div class="line">    <span class="attribute">location</span> / &#123;</div><div class="line">        <span class="attribute">proxy_pass</span>              http://socket_test/;</div><div class="line">        <span class="attribute">proxy_set_header</span>        Upgrade <span class="variable">$http_upgrade</span>;</div><div class="line">        <span class="attribute">proxy_set_header</span>        Connection <span class="string">"upgrade"</span>;</div><div class="line">        <span class="attribute">proxy_http_version</span>      <span class="number">1</span>.<span class="number">1</span>;</div><div class="line">        <span class="attribute">proxy_set_header</span>        Host <span class="variable">$host</span>;</div><div class="line">        <span class="attribute">proxy_set_header</span>        X-Real-IP <span class="variable">$remote_addr</span>;</div><div class="line">        <span class="attribute">proxy_set_header</span>        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>启动两个项目实例，分别监听8013和8014端口；<br>然后启动nginx</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nginx</div></pre></td></tr></table></figure><p>通过测试会发现，消息有时候能收到，有时候收不到。原因是因为客户端请求的时候，会不定的请求服务端两个实例中的一个，如果连接的时候是请求的8013端口的实例，二发送消息是8014端口的实例 ，就会在8014的实例中找不到建立连接的socket。</p><h3 id="四、分布式解决方法"><a href="#四、分布式解决方法" class="headerlink" title="四、分布式解决方法"></a>四、分布式解决方法</h3><p>socket.io官网中提供了使用<a href="https://github.com/socketio/socket.io-redis" target="_blank" rel="external">socket.io-redis</a><br>来解决此方法；socket.io-redis中使用了redis的消息订阅与发布的功能，当有通知发送的时候，会触发onmessage事件，然后会调用broadcast广播。</p><p>接下来将socket.io-redis添加到index.js文件中</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//index.js</span></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> app = express();</div><div class="line"><span class="keyword">var</span> server = <span class="built_in">require</span>(<span class="string">'http'</span>).Server(app);</div><div class="line"><span class="keyword">var</span> io = <span class="built_in">require</span>(<span class="string">'socket.io'</span>)(server,&#123;</div><div class="line">    <span class="string">"path"</span>:<span class="string">"/notice"</span>  <span class="comment">//修改客户端请求的路径，默认为/socket.io</span></div><div class="line">&#125;);</div><div class="line"><span class="keyword">new</span> (<span class="built_in">require</span>(<span class="string">"./notice"</span>).init)(io); <span class="comment">//传入io</span></div><div class="line"><span class="keyword">var</span> redis = <span class="built_in">require</span>(<span class="string">'socket.io-redis'</span>);</div><div class="line">io.adapter(redis(&#123; <span class="attr">host</span>: settings.REDIS_HOST, <span class="attr">port</span>: settings.REDIS_PORT &#125;));</div></pre></td></tr></table></figure><p>然后重启后会发现还是不行，原因是因为在socketMap变量中有时候就找不到对应的user_id;因为是分布式的，所有socketMap变量在两台实例中并不是共享的，所以这里使用redis，在socket建立的时候将user_id对应的socket_id存储到redis中，发送消息的时候从redis中读取socket_id这样就可以了。</p><p>有时候一个用户可能会同时有多个socket连接，所以user_id对应的socket_id就可以是一个数组，发送消息的时候要循环发送，连接断开的时候要只删除对应的socket_id,保留其他建立的连接。</p><p>另外服务器重启时socket会重新建立连接，所以在初始化的的时候要清空redis中所有存储的数据。</p><div style="text-align:right;font-size:12px;color:#666;">—-publish by <a href="http://ceditor.alibt.top" target="_blank">CEditor</a></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近在用nodejs实现一个消息通知的功能，其中用到了socket.io；由于初次使用socket.io，在网上查找资料大都是聊天室广播的教程，没有找到一对一发送消息的具体实现方法，这里分享一下自己学习使用过程中踩到某些坑和最终实现方法。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="socket.io" scheme="http://blog.cuiyy.top/tags/socket-io/"/>
    
  </entry>
  
  <entry>
    <title>GitHub webhooks实现自动部署</title>
    <link href="http://blog.cuiyy.top/2017/09/27/pM6JLsCa29henIyW/"/>
    <id>http://blog.cuiyy.top/2017/09/27/pM6JLsCa29henIyW/</id>
    <published>2017-09-27T03:33:39.000Z</published>
    <updated>2017-10-11T02:05:18.136Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>使用第三方Git仓库，实现代码的自动部署<br>GitHub 提供了Webhooks的功能，我们通过相应的配置就可以实现在代码提交到GitHub后自动部署我们的项目</p></blockquote><a id="more"></a><h3 id="在GitHub添加部署服务器的ssh-key"><a href="#在GitHub添加部署服务器的ssh-key" class="headerlink" title="在GitHub添加部署服务器的ssh key"></a>在GitHub添加部署服务器的ssh key</h3><p>1、首先在服务器生成<a href="/2017/05/02/ssh-免密码登录/">ssh key</a><br>2、添加<code>ssh key</code>到GitHub账户中</p><p>选择<code>setting</code> -&gt; <code>SSH and GPG keys</code> -&gt; <code>New SSH Key</code> 添加</p><h3 id="配置Webhooks"><a href="#配置Webhooks" class="headerlink" title="配置Webhooks"></a>配置Webhooks</h3><p>打开需要配置<code>Webhooks</code>的项目，点击<code>Settings</code>，选择<code>Webhooks</code></p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fgagteiy5ej31ji120dmi.jpg" alt="Webhooks 设置" title=""> </div> <div class="image-caption">Webhooks 设置</div> </figure><p>设置触发事件后请求的地址及方法，并选择触发事件的类型，此处选择为<code>push</code>,当我们提交代码的时候触发；设置完成后，点击添加即可。</p><h3 id="服务器编辑接受处理代码"><a href="#服务器编辑接受处理代码" class="headerlink" title="服务器编辑接受处理代码"></a>服务器编辑接受处理代码</h3><p>以<code>nodejs</code> 的 <code>express</code>为例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> shell = <span class="built_in">require</span>(<span class="string">'shelljs'</span>); <span class="comment">// shell npm 包工具</span></div><div class="line"><span class="keyword">var</span> setting = <span class="built_in">require</span>(<span class="string">'../setting'</span>);</div><div class="line"><span class="keyword">var</span> blogPath  = setting.blog.path;</div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> body = req.body;</div><div class="line">    <span class="built_in">console</span>.log(body) <span class="comment">// git 推送的数据</span></div><div class="line">    <span class="keyword">if</span> (!shell.which(<span class="string">'git'</span>)) &#123; <span class="comment">// 判断是否存在git命令</span></div><div class="line">      shell.echo(<span class="string">'Sorry, this script requires git'</span>);</div><div class="line">      shell.exit(<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> cd = shell.cd(blogPath);</div><div class="line">    <span class="keyword">if</span> (!cd.code)&#123;</div><div class="line">        <span class="comment">// 执行git代码拉取操作</span></div><div class="line">        <span class="keyword">if</span> (shell.exec(<span class="string">'git pull origin master'</span>).code !== <span class="number">0</span>) &#123;</div><div class="line">          shell.echo(<span class="string">'Error: Git pull error!'</span>);</div><div class="line">          shell.exit(<span class="number">1</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    res.end();</div><div class="line">&#125;</div></pre></td></tr></table></figure><div style="text-align:right;font-size:12px;color:#666;">—-publish by <a href="http://ceditor.alibt.top" target="_blank">CEditor</a></div>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;使用第三方Git仓库，实现代码的自动部署&lt;br&gt;GitHub 提供了Webhooks的功能，我们通过相应的配置就可以实现在代码提交到GitHub后自动部署我们的项目&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Git" scheme="http://blog.cuiyy.top/tags/Git/"/>
    
      <category term="webhooks" scheme="http://blog.cuiyy.top/tags/webhooks/"/>
    
  </entry>
  
  <entry>
    <title>让你备受刮目相看的8个npm技巧</title>
    <link href="http://blog.cuiyy.top/2017/09/27/dp034EZKdW2mePbk/"/>
    <id>http://blog.cuiyy.top/2017/09/27/dp034EZKdW2mePbk/</id>
    <published>2017-09-27T02:26:54.000Z</published>
    <updated>2017-10-11T03:26:49.550Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>本文转载自：<a href="http://www.zcfy.cc" target="_blank" rel="external">众成翻译</a><br>译者：<a href="http://www.zcfy.cc/@liuhui_is_me" target="_blank" rel="external">liuhui_is_me</a><br>链接：<a href="http://www.zcfy.cc/article/3362" target="_blank" rel="external">http://www.zcfy.cc/article/3362</a><br>原文：<a href="https://medium.freecodecamp.com/8-npm-tricks-you-can-use-to-impress-your-colleagues-dbdae1ef5f9e" target="_blank" rel="external">https://medium.freecodecamp.com/8-npm-tricks-you-can-use-to-impress-your-colleagues-dbdae1ef5f9e</a></p></blockquote><p>你观看一个同事编码时候，你会看到一些速记和技巧被应用，有些方式你并不熟悉，那你就被鄙视了，这种事情在我们每一个一生都会发生的。</p><p>在这篇文章中，我将介绍一些很有用的npm技巧，还有很多这里并不能全收录，我们只关注那些相关的并且有益于我们每天的工作和开发的技巧。<br><a id="more"></a></p><h3 id="基本的速记"><a href="#基本的速记" class="headerlink" title="基本的速记"></a>基本的速记</h3><p>为了让大家的对npm有一个一致的理解，尤其是我们的新人，让我们快速了解基本的速记和确保没有错过任何细节。</p><h4 id="安装安装包"><a href="#安装安装包" class="headerlink" title="安装安装包"></a>安装安装包</h4><p>常规: <code>npm install pkg</code>, 速记: <code>npm i pkg</code>.</p><h4 id="全局安装包"><a href="#全局安装包" class="headerlink" title="全局安装包:"></a>全局安装包:</h4><p>常规: <code>npm i --global pkg</code>, 速记: <code>npm i -g pkg</code>.</p><h4 id="安装包并包含在依赖中"><a href="#安装包并包含在依赖中" class="headerlink" title="安装包并包含在依赖中:"></a>安装包并包含在依赖中:</h4><p>常规: <code>npm i --save pkg</code>, 速记: <code>npm i -S pkg</code>.</p><h4 id="安装包并包含在开发依赖中"><a href="#安装包并包含在开发依赖中" class="headerlink" title="安装包并包含在开发依赖中:"></a>安装包并包含在开发依赖中:</h4><p>常规: <code>npm i --save-dev pkg</code>, 速记: <code>npm i -D pkg</code>.</p><p>其他的npm速记阅读npm博客 <a href="https://docs.npmjs.com/misc/config#shorthands-and-other-cli-niceties" target="_blank" rel="external">速记表</a>.</p><p>下面开始有趣的内容。</p><h4 id="1-初始化一个新包"><a href="#1-初始化一个新包" class="headerlink" title="1. 初始化一个新包"></a>1. 初始化一个新包</h4><p>我们都知道<code>npm init</code>，用来创建一个新的包。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t01d9e905292304482f.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>但是，所有的问题都是匿名的，我们无论如何都会修改它的，那么怎么避免发生呢？</p><p>使用<code>npm init -y</code> 和 <code>npm init -f</code>回到初始化！</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t018b19458ea1e4f29c.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><h4 id="2-运行测试命令"><a href="#2-运行测试命令" class="headerlink" title="2. 运行测试命令"></a>2. 运行测试命令</h4><p>另一个命令就是<code>npm test</code>,我们可能每天使用依次或者一天使用好几次。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t013675388a929b715a.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>如果我告诉你可以使用少于40%的字符去完成这个功能？我们经常使用，应该这样。</p><p>幸运的是，我们可以使用<code>npm t</code>，它就可以胜任</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t0119b0f93fdbce3c52.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><h4 id="3-枚举可用的脚本"><a href="#3-枚举可用的脚本" class="headerlink" title="3. 枚举可用的脚本"></a>3. 枚举可用的脚本</h4><p>我们开始一个新项目，我们想知道如何开始。我们通常会问自己这样的问题：我们如何运行它？哪些脚本可用？</p><p>一个方法是打开package.json文件并检查<code>scripts</code>部分。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t01e0d5d6b57de82093.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>我们可以做的更好，当然，我们只是运行<code>npm run</code>得到一个的所有可用的脚本的列表。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t0185df886f66ed19f9.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>另外的可以选择是安装<code>ntl</code> (<code>npm i -g ntl</code>)，然后运行<code>ntl</code>在项目文件夹中。它也可以运行脚本，也很方面。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t01c60c779d0d614408.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><h4 id="4-枚举已经安装的包"><a href="#4-枚举已经安装的包" class="headerlink" title="4. 枚举已经安装的包"></a>4. 枚举已经安装的包</h4><p>类似于可用的脚本，有时我们会问自己我们的项目中有哪些依赖项。</p><p>我们可以再次打开package.json文件和检查，但是我们已经做的更好了。</p><p>使用 <code>npm ls --depth 0</code>.</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t014ad711b281c288ae.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>枚举全局安装包，使用<code>npm ls -g --depth 0</code></p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t01ab4908f2e4500392.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><h4 id="5-运行本地安装的可执行文件"><a href="#5-运行本地安装的可执行文件" class="headerlink" title="5. 运行本地安装的可执行文件"></a>5. 运行本地安装的可执行文件</h4><p>我们安装了一个包在我们的项目中，它是一个可执行的，但我们只能运行它通过一个新的脚本。你想知道为什么，或者如何克服它？</p><p>首先，让我们了解为什么——当我们在终端中执行命令时，实际发生的是它在PATH环境变量中列出的所有路径中查找一个具有相同名称的可执行文件。这就是他们如何神奇地从任何地方都可以执行。本地安装的软件包登记他们的可执行文件在本地，所以他们不在我们的<code>PATH</code>路径中将不会被发现。</p><p>当我们运行这些可执行文件通过一个新脚本，它是如何工作的呢？你可能会问？很好的问题！这是因为这种方式运行时，NPM做了一点技巧和增加了一个额外的文件夹到<code>PATH</code>，<code>/node_modules/.bin</code>中。<br>你可以看到它的运行<code>npm run env | grep &quot;$PATH&quot;</code>。你也可以运行只是<code>npm run env</code> 查看所有可用的环境变量，npm增加了一些更有趣的东西。<br><code>/node_modules/.bin</code>，如果你不知道，正是在本地安装的软件包放置可执行文件的地方。</p><p>我们可以运行 <code>./node_modules/.bin/mocha</code> 在我们的项目中，看看将会发生什么.</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t011a44c15fdb274912.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>很简单, 对吧? 仅仅运行 <code>./node_modules/.bin/</code> ，无论什么时候你想要运行本地已安装的可执行文件。</p><h4 id="6-在网上查找你想要的包"><a href="#6-在网上查找你想要的包" class="headerlink" title="6. 在网上查找你想要的包"></a>6. 在网上查找你想要的包</h4><p>你可能看到了<code>repository</code>这个入口在package.json文件中，疑问“这有什么好处？”</p><p>为了问答这个问题，仅仅运行<code>npm repo</code>然后在你的浏览器中查看。</p><p>与之类似,<code>npm home</code>命令进入主页。</p><p>如果你想打开你的包的主页<a href="https://www.npmjs.com/" target="_blank" rel="external">npmjs.com</a>，那是一个不错的速记，<code>npm docs</code>。</p><h4 id="7-在其他脚本前后运行脚本"><a href="#7-在其他脚本前后运行脚本" class="headerlink" title="7. 在其他脚本前后运行脚本"></a>7. 在其他脚本前后运行脚本</h4><p>您可能熟悉诸如<code>pretest</code>之类的脚本，它允许您定义在<code>test</code>脚本之前运行的代码。</p><p>您可能会惊讶地发现，您可以为每个脚本配置或有或后的脚本，包括您自己的自定义脚本！</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t010206810a272d84df.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><p>对于项目中，你使用NPM作为您的构建工具，有很多脚本，你需要自己总结使用。</p><h4 id="8-修改包的版本"><a href="#8-修改包的版本" class="headerlink" title="8. 修改包的版本"></a>8. 修改包的版本</h4><p>你开发一个安装包，你使用<a href="http://semver.org/" target="_blank" rel="external">semver</a>作为版本管理工具，修改一个新版本。</p><p>通过这种方式，你需要手动的修改package.json文件，我们不推荐这样做。</p><p>更容易的方式是运行<code>npm version</code> 通过 <code>major</code>, <code>minor</code> 或者 <code>patch</code></p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://p0.qhimg.com/t01794393233d68fbaf.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;本文转载自：&lt;a href=&quot;http://www.zcfy.cc&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;众成翻译&lt;/a&gt;&lt;br&gt;译者：&lt;a href=&quot;http://www.zcfy.cc/@liuhui_is_me&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;liuhui_is_me&lt;/a&gt;&lt;br&gt;链接：&lt;a href=&quot;http://www.zcfy.cc/article/3362&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.zcfy.cc/article/3362&lt;/a&gt;&lt;br&gt;原文：&lt;a href=&quot;https://medium.freecodecamp.com/8-npm-tricks-you-can-use-to-impress-your-colleagues-dbdae1ef5f9e&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://medium.freecodecamp.com/8-npm-tricks-you-can-use-to-impress-your-colleagues-dbdae1ef5f9e&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;你观看一个同事编码时候，你会看到一些速记和技巧被应用，有些方式你并不熟悉，那你就被鄙视了，这种事情在我们每一个一生都会发生的。&lt;/p&gt;
&lt;p&gt;在这篇文章中，我将介绍一些很有用的npm技巧，还有很多这里并不能全收录，我们只关注那些相关的并且有益于我们每天的工作和开发的技巧。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="npm" scheme="http://blog.cuiyy.top/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>pm2怎么指定master</title>
    <link href="http://blog.cuiyy.top/2017/08/08/7URpImMqF24g6oKs/"/>
    <id>http://blog.cuiyy.top/2017/08/08/7URpImMqF24g6oKs/</id>
    <published>2017-08-08T06:59:46.000Z</published>
    <updated>2017-08-08T07:10:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>node集群启动模式通常会这样写</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cluster = <span class="built_in">require</span>(<span class="string">'cluster'</span>);  </div><div class="line"><span class="keyword">var</span> http    = <span class="built_in">require</span>(<span class="string">'http'</span>);  </div><div class="line"><span class="keyword">var</span> os      = <span class="built_in">require</span>(<span class="string">'os'</span>);</div><div class="line"><span class="keyword">var</span> numCPUs = os.cpus().length;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(cluster.isMaster)&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; numCPUs; ++i) &#123;</div><div class="line">    cluster.fork();</div><div class="line">  &#125;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.writeHead(<span class="number">200</span>);</div><div class="line">    res.end(<span class="string">"hello world"</span>);</div><div class="line">  &#125;).listen(<span class="number">8080</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>我们可以通过<code>cluster.isMaster</code>来执行一些任务;<br><a href="http://pm2.keymetrics.io/" target="_blank" rel="external">pm2</a>是一个很好的<code>nodejs</code> 管理工具，我们可以通过配置来启动我们的<code>nodejs</code>服务，他的代码和我们平常写的一样。<br>例如：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"></div><div class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req, res</span>) </span>&#123;  </div><div class="line">  res.writeHead(<span class="number">200</span>);</div><div class="line">  res.end(<span class="string">"hello world"</span>);</div><div class="line">&#125;).listen(<span class="number">8080</span>);</div></pre></td></tr></table></figure></p><p>但是我们想只在<code>master</code>上做一些任务，改怎么做呢？<br>下面跟出一中方法：<br>我们可以通过两个配置，分别指定不同的命令行参数来区别：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"apps"</span> : [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"Master"</span>,</div><div class="line">      <span class="attr">"script"</span>: <span class="string">"app.js"</span>,</div><div class="line">      <span class="attr">"args"</span>: [<span class="string">"master"</span>],</div><div class="line">      <span class="attr">"instances"</span>: <span class="string">"1"</span>,</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"name"</span>: <span class="string">"Slave"</span>,</div><div class="line">      <span class="attr">"script"</span>: <span class="string">"app.js"</span>,</div><div class="line">      <span class="attr">"args"</span>: [<span class="string">"slave"</span>],</div><div class="line">      <span class="attr">"instances"</span>: <span class="string">"-1"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>然后在<code>app.js</code>中这样写：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (process.argv[<span class="number">2</span>] === <span class="string">'master'</span>)&#123;</div><div class="line">   <span class="comment">// ...</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>也可以通过其他环境变量参数来区分那个是<code>master</code>。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;node集群启动模式通常会这样写&lt;/p&gt;
&lt;figure class=&quot;highlight js&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;d
      
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="pm2" scheme="http://blog.cuiyy.top/tags/pm2/"/>
    
  </entry>
  
  <entry>
    <title>搭建网盘服务器</title>
    <link href="http://blog.cuiyy.top/2017/07/18/YocazGnoJ07Z4rms/"/>
    <id>http://blog.cuiyy.top/2017/07/18/YocazGnoJ07Z4rms/</id>
    <published>2017-07-18T02:00:11.000Z</published>
    <updated>2017-07-19T03:24:11.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装-Seafile-服务器"><a href="#安装-Seafile-服务器" class="headerlink" title="安装 Seafile 服务器"></a>安装 Seafile 服务器</h2><h3 id="安装依赖环境"><a href="#安装依赖环境" class="headerlink" title="安装依赖环境"></a>安装依赖环境</h3><p>在 Debian/Ubuntu 系统下，可以使用以下命令安装 MySQL：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div><div class="line">sudo apt-get install mysql-server</div></pre></td></tr></table></figure><p>使用以下命令安装 Python 相关依赖：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install python2.7 python-setuptools python-imaging python-ldap python-mysqldb python-memcache python-urllib3</div></pre></td></tr></table></figure><p>安装 MySQL 过程需要为 MySQL 的 root 用户设置新密码，请记住该[密码]以供后面步骤使用。<br><a id="more"></a></p><h2 id="为-Seafile-创建一个用户"><a href="#为-Seafile-创建一个用户" class="headerlink" title="为 Seafile 创建一个用户"></a>为 Seafile 创建一个用户</h2><p>创建 Seafile 用户，使用它运行 Seafile 服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo useradd -m -s /bin/bash seafile</div></pre></td></tr></table></figure><h3 id="为该用户设置密码："><a href="#为该用户设置密码：" class="headerlink" title="为该用户设置密码："></a>为该用户设置密码：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo passwd seafile</div></pre></td></tr></table></figure><h2 id="下载Seafile"><a href="#下载Seafile" class="headerlink" title="下载Seafile"></a>下载Seafile</h2><h3 id="切换到新用户，需要输入你刚才为seafile用户设置的密码："><a href="#切换到新用户，需要输入你刚才为seafile用户设置的密码：" class="headerlink" title="切换到新用户，需要输入你刚才为seafile用户设置的密码："></a>切换到新用户，需要输入你刚才为seafile用户设置的密码：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">su - seafile</div></pre></td></tr></table></figure><h3 id="切换目录："><a href="#切换目录：" class="headerlink" title="切换目录："></a>切换目录：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~</div></pre></td></tr></table></figure><p>这里可以查看获取最新 Seafile 下载链接，参考以下命令进行下载。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">wget http://seafile-downloads.oss-cn-shanghai.aliyuncs.com/seafile-server_6.1.1_i386.tar.gz</div><div class="line"></div><div class="line"><span class="meta">#</span><span class="bash"> 64位：</span></div><div class="line"><span class="meta">#</span><span class="bash"> https://download.seadrive.org/seafile-server_6.1.1_x86-64.tar.gz</span></div></pre></td></tr></table></figure><h3 id="解压"><a href="#解压" class="headerlink" title="解压:"></a>解压:</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tar -xzf seafile-server_*</div><div class="line">mv seafile-server-*/ seafile-server/</div></pre></td></tr></table></figure><h2 id="配置-Seafile"><a href="#配置-Seafile" class="headerlink" title="配置 Seafile"></a>配置 Seafile</h2><p>运行Seafile设置脚本，并回答预设问题：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd seafile-server*</div><div class="line">./setup-seafile-mysql.sh</div></pre></td></tr></table></figure><p>执行过程输入参数如下图：<br>其中：<br>[ This server’s ip or domain ] 字段输入服务器IP地址（111.111.111.111）。<br>mysql 的 [ root password ] 字段输入数据库密码。<br>其他字段一路回车使用默认值。</p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws3.sinaimg.cn/large/006tNc79ly1fhp0relpz6j30f90nxgp9.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure><h2 id="启动-Seafile"><a href="#启动-Seafile" class="headerlink" title="启动 Seafile"></a>启动 Seafile</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">./seafile.sh start</div><div class="line">./seahub.sh start</div></pre></td></tr></table></figure><p>执行过程输入参数如截图所示，其中 [ admin email ] 设置为您登录网盘的帐号，如 <code>xxx@xxx.com</code><br>[ admin password ] 和 [ admin password again ] 设置为登录网盘的密码，如 <code>xxxxxxx</code></p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws3.sinaimg.cn/large/006tNc79ly1fhp0thvmy1j30gw06ywf8.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure><h2 id="大功告成！"><a href="#大功告成！" class="headerlink" title="大功告成！"></a>大功告成！</h2><p>恭喜，您的 Seafile 已经部署完成，您现在拥有专属的网盘了，登录的帐号密码为您启动 Seafile 步骤中设置的邮箱和密码。<br>可以通过 IP 访问网盘：<a href="http://111.111.111.111:8000" target="_blank" rel="external">http://111.111.111.111:8000</a></p><p><em>注意</em><br>安装过程中会出现类似错误<br><code>error while loading shared libraries: libselinux.so.1: cannot open shared object file: No such file or directory</code></p><p>这是由于安装包与系统位不同导致的，64位系统要下载对应的64位的安装包</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;安装-Seafile-服务器&quot;&gt;&lt;a href=&quot;#安装-Seafile-服务器&quot; class=&quot;headerlink&quot; title=&quot;安装 Seafile 服务器&quot;&gt;&lt;/a&gt;安装 Seafile 服务器&lt;/h2&gt;&lt;h3 id=&quot;安装依赖环境&quot;&gt;&lt;a href=&quot;#安装依赖环境&quot; class=&quot;headerlink&quot; title=&quot;安装依赖环境&quot;&gt;&lt;/a&gt;安装依赖环境&lt;/h3&gt;&lt;p&gt;在 Debian/Ubuntu 系统下，可以使用以下命令安装 MySQL：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo apt-get update&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;sudo apt-get install mysql-server&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;使用以下命令安装 Python 相关依赖：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo apt-get install python2.7 python-setuptools python-imaging python-ldap python-mysqldb python-memcache python-urllib3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;安装 MySQL 过程需要为 MySQL 的 root 用户设置新密码，请记住该[密码]以供后面步骤使用。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="网盘" scheme="http://blog.cuiyy.top/tags/%E7%BD%91%E7%9B%98/"/>
    
  </entry>
  
  <entry>
    <title>搭建FTP服务器</title>
    <link href="http://blog.cuiyy.top/2017/07/17/5ykC26xyTqYUFCqG/"/>
    <id>http://blog.cuiyy.top/2017/07/17/5ykC26xyTqYUFCqG/</id>
    <published>2017-07-17T12:10:11.000Z</published>
    <updated>2017-07-19T03:24:20.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="安装并启动-FTP-服务"><a href="#安装并启动-FTP-服务" class="headerlink" title="安装并启动 FTP 服务"></a>安装并启动 FTP 服务</h2><h3 id="安装-VSFTPD"><a href="#安装-VSFTPD" class="headerlink" title="安装 VSFTPD"></a>安装 VSFTPD</h3><p>使用 <code>apt-get</code> 安装 <code>vsftpd</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install vsftpd -y</div></pre></td></tr></table></figure><h3 id="启动-VSFTPD"><a href="#启动-VSFTPD" class="headerlink" title="启动 VSFTPD"></a>启动 VSFTPD</h3><p>安装完成后 VSFTPD 会自动启动，通过 <code>netstat</code> 命令可以看到系统已经监听了 21 端口</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo netstat -nltp | grep 21</div></pre></td></tr></table></figure><p>如果没有启动，可以手动开启 <code>VSFTPD</code> 服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo systemctl start vsftpd.service</div></pre></td></tr></table></figure><a id="more"></a><h2 id="配置用户访问目录"><a href="#配置用户访问目录" class="headerlink" title="配置用户访问目录"></a>配置用户访问目录</h2><h3 id="新建用户主目录"><a href="#新建用户主目录" class="headerlink" title="新建用户主目录"></a>新建用户主目录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mkdir /home/uftp</div></pre></td></tr></table></figure><p>执行完后，在这里 <code>/home/uftp</code></p><p>就能看到新建的文件夹 <code>uftp</code> 了。</p><h3 id="创建登录欢迎文件"><a href="#创建登录欢迎文件" class="headerlink" title="创建登录欢迎文件"></a>创建登录欢迎文件</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo touch /home/uftp/welcome.txt</div></pre></td></tr></table></figure><p>###新建用户 <code>uftp</code> 并设置密码<br>创建一个用户 <code>uftp</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo useradd -d /home/uftp -s /bin/bash uftp</div></pre></td></tr></table></figure><p>为用户 <code>uftp</code> 设置密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo passwd uftp</div></pre></td></tr></table></figure><p>删除掉 <code>pam.d</code> 中 <code>vsftpd</code>，因为该配置文件会导致使用用户名登录 <code>ftp</code> 失败：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo rm /etc/pam.d/vsftpd</div></pre></td></tr></table></figure><h2 id="限制该用户仅能通过-FTP-访问"><a href="#限制该用户仅能通过-FTP-访问" class="headerlink" title="限制该用户仅能通过 FTP 访问"></a>限制该用户仅能通过 FTP 访问</h2><p>限制用户 uftp 只能通过 FTP 访问服务器，而不能直接登录服务器：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo usermod -s /sbin/nologin uftp</div></pre></td></tr></table></figure><p>修改 <code>vsftpd</code> 配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod a+w /etc/vsftpd.conf</div></pre></td></tr></table></figure><p>修改 <code>/etc/vsftpd.conf</code> 文件中的配置（直接将如下配置添加到配置文件最下方）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># 限制用户对主目录以外目录访问</div><div class="line">chroot_local_user=YES</div><div class="line"></div><div class="line"># 指定一个 userlist 存放允许访问 ftp 的用户列表</div><div class="line">userlist_deny=NO</div><div class="line">userlist_enable=YES</div><div class="line"></div><div class="line"># 记录允许访问 ftp 用户列表</div><div class="line">userlist_file=/etc/vsftpd.user_list</div><div class="line"></div><div class="line"># 不配置可能导致莫名的530问题</div><div class="line">seccomp_sandbox=NO</div><div class="line"></div><div class="line"># 允许文件上传</div><div class="line">write_enable=YES</div><div class="line"></div><div class="line"># 使用utf8编码</div><div class="line">utf8_filesystem=YES</div></pre></td></tr></table></figure><h3 id="新建文件-etc-vsftpd-user-list，用于存放允许访问-ftp-的用户："><a href="#新建文件-etc-vsftpd-user-list，用于存放允许访问-ftp-的用户：" class="headerlink" title="新建文件 /etc/vsftpd.user_list，用于存放允许访问 ftp 的用户："></a>新建文件 <code>/etc/vsftpd.user_list</code>，用于存放允许访问 ftp 的用户：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo touch /etc/vsftpd.user_list</div><div class="line">sudo chmod a+w /etc/vsftpd.user_list</div></pre></td></tr></table></figure><p>修改 <code>/etc/vsftpd.user_list</code> ，加入刚刚创建的用户：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">vsftpd.user_list</div><div class="line">uftp</div></pre></td></tr></table></figure><h2 id="设置访问权限"><a href="#设置访问权限" class="headerlink" title="设置访问权限"></a>设置访问权限</h2><h3 id="设置主目录访问权限（只读）"><a href="#设置主目录访问权限（只读）" class="headerlink" title="设置主目录访问权限（只读）"></a>设置主目录访问权限（只读）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod a-w /home/uftp</div></pre></td></tr></table></figure><h3 id="新建公共目录，并设置权限（读写）"><a href="#新建公共目录，并设置权限（读写）" class="headerlink" title="新建公共目录，并设置权限（读写）"></a>新建公共目录，并设置权限（读写）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo mkdir /home/uftp/public &amp;&amp; sudo chmod 777 -R /home/uftp/public</div></pre></td></tr></table></figure><h3 id="重启vsftpd-服务："><a href="#重启vsftpd-服务：" class="headerlink" title="重启vsftpd 服务："></a>重启vsftpd 服务：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo systemctl restart vsftpd.service</div></pre></td></tr></table></figure><h2 id="访问-FTP-服务"><a href="#访问-FTP-服务" class="headerlink" title="访问 FTP 服务"></a>访问 FTP 服务</h2><p>FTP 服务已安装并配置完成，下面我们来使用该 FTP 服务访问 FTP 服务<br>根据您个人的工作环境，选择一种方式来访问已经搭建的 FTP 服务</p><p>###通过 FTP 客户端工具访问<br>FTP 客户端工具众多，下面推荐两个常用的：<br>FileZilla - 跨平台的 FTP 客户端，支持 Windows 和 Mac<br>WinSCP - Windows 下的 FTP 和 SFTP 连接客户端<br>下载和安装 FTP 客户端后，使用下面的凭据进行连接即可：<br>主机 111.111.111.11<br>用户：uftp</p><p>输入密码后，如果能够正常连接，那么大功告成，您可以开始使用属于您自己的 FTP 服务器了！<br>接下来，请上传任意一张图片到您的 FTP 服务器上的 <code>uftp</code> 的 <code>public</code> 目录下，然后，就可以在 <code>/home/uftp/public</code> 中看到了。</p><p>###通过 Windows 资源管理器访问<br>Windows 用户可以复制下面的链接<br>到资源管理器的地址栏访问：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ftp://uftp:你的密码@111.111.111.11</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;安装并启动-FTP-服务&quot;&gt;&lt;a href=&quot;#安装并启动-FTP-服务&quot; class=&quot;headerlink&quot; title=&quot;安装并启动 FTP 服务&quot;&gt;&lt;/a&gt;安装并启动 FTP 服务&lt;/h2&gt;&lt;h3 id=&quot;安装-VSFTPD&quot;&gt;&lt;a href=&quot;#安装-VSFTPD&quot; class=&quot;headerlink&quot; title=&quot;安装 VSFTPD&quot;&gt;&lt;/a&gt;安装 VSFTPD&lt;/h3&gt;&lt;p&gt;使用 &lt;code&gt;apt-get&lt;/code&gt; 安装 &lt;code&gt;vsftpd&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo apt-get install vsftpd -y&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;启动-VSFTPD&quot;&gt;&lt;a href=&quot;#启动-VSFTPD&quot; class=&quot;headerlink&quot; title=&quot;启动 VSFTPD&quot;&gt;&lt;/a&gt;启动 VSFTPD&lt;/h3&gt;&lt;p&gt;安装完成后 VSFTPD 会自动启动，通过 &lt;code&gt;netstat&lt;/code&gt; 命令可以看到系统已经监听了 21 端口&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo netstat -nltp | grep 21&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果没有启动，可以手动开启 &lt;code&gt;VSFTPD&lt;/code&gt; 服务：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;sudo systemctl start vsftpd.service&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="FTP" scheme="http://blog.cuiyy.top/tags/FTP/"/>
    
  </entry>
  
  <entry>
    <title>Vue.js 简单的拖拽排序组件</title>
    <link href="http://blog.cuiyy.top/2017/06/27/JQeeQ6YFw3kcrMxh/"/>
    <id>http://blog.cuiyy.top/2017/06/27/JQeeQ6YFw3kcrMxh/</id>
    <published>2017-06-27T12:10:11.000Z</published>
    <updated>2017-07-03T08:11:38.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="需求描述"><a href="#需求描述" class="headerlink" title="需求描述"></a>需求描述</h3><h3 id="拖动属性及拖动事件"><a href="#拖动属性及拖动事件" class="headerlink" title="拖动属性及拖动事件"></a>拖动属性及拖动事件</h3><h3 id="接收默认数据"><a href="#接收默认数据" class="headerlink" title="接收默认数据"></a>接收默认数据</h3><h3 id="拖动重新排序"><a href="#拖动重新排序" class="headerlink" title="拖动重新排序"></a>拖动重新排序</h3><h3 id="修改原始数据"><a href="#修改原始数据" class="headerlink" title="修改原始数据"></a>修改原始数据</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;需求描述&quot;&gt;&lt;a href=&quot;#需求描述&quot; class=&quot;headerlink&quot; title=&quot;需求描述&quot;&gt;&lt;/a&gt;需求描述&lt;/h3&gt;&lt;h3 id=&quot;拖动属性及拖动事件&quot;&gt;&lt;a href=&quot;#拖动属性及拖动事件&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Vue.js" scheme="http://blog.cuiyy.top/tags/Vue-js/"/>
    
  </entry>
  
  <entry>
    <title>nodejs http.request 设置超时</title>
    <link href="http://blog.cuiyy.top/2017/06/23/ujZ8WMuDA7TISLvv/"/>
    <id>http://blog.cuiyy.top/2017/06/23/ujZ8WMuDA7TISLvv/</id>
    <published>2017-06-23T13:19:11.000Z</published>
    <updated>2017-06-26T03:43:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>使用<code>nodejs</code>在请求第三方接口的时候，经常会用到<code>http.request()</code>方法；为了防止请求等待时间过长，我们可以为其设置超时时间。<br><a id="more"></a><br>在请求参数中添加<code>timeout</code>参数<br>例如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> options = &#123; </div><div class="line">    hostname: <span class="string">'127.0.0'</span>, </div><div class="line">    port: <span class="number">8080</span>, </div><div class="line">    path: <span class="string">'/x'</span>, </div><div class="line">    method: <span class="string">'GET'</span>,</div><div class="line">    timeout: <span class="number">500</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> req = http.request(options, <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</div><div class="line">    res.on(<span class="string">'data'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">chunk</span>) </span>&#123; </div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'BODY: '</span> + chunk); </div><div class="line">    &#125;);</div><div class="line">    res.on(<span class="string">'end'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'请求完成'</span>);</div><div class="line">    &#125;);</div><div class="line">    res.on(<span class="string">'timeout'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'请求超时'</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;);</div><div class="line">req.on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123; </div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'请求失败: '</span> + e.message); </div><div class="line">&#125;);</div><div class="line">req.end();</div></pre></td></tr></table></figure><p>请求超过500毫秒后，会终止请求，同时触发<code>timeout</code>事件，我们可以监听此事件，在请求超时后做一些处理。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;使用&lt;code&gt;nodejs&lt;/code&gt;在请求第三方接口的时候，经常会用到&lt;code&gt;http.request()&lt;/code&gt;方法；为了防止请求等待时间过长，我们可以为其设置超时时间。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="http" scheme="http://blog.cuiyy.top/tags/http/"/>
    
  </entry>
  
  <entry>
    <title>browsersync 省时的浏览器同步测试工具</title>
    <link href="http://blog.cuiyy.top/2017/06/23/Tve7kc4flBoVIhdF/"/>
    <id>http://blog.cuiyy.top/2017/06/23/Tve7kc4flBoVIhdF/</id>
    <published>2017-06-23T01:58:32.000Z</published>
    <updated>2017-06-23T02:42:16.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Browsersync能让浏览器实时、快速响应您的文件更改（html、js、css、sass、less等）并自动刷新页面。<br>更重要的是 Browsersync可以同时在PC、平板、手机等设备下进项调试。<br>您可以想象一下：“假设您的桌子上有pc、ipad、iphone、android等设备，同时打开了您需要调试的页面，当您使用browsersync后，您的任何一次代码保存，以上的设备都会同时显示您的改动”。<br>无论您是前端还是后端工程师，使用它将提高您30%的工作效率。</p></blockquote><a id="more"></a><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="http://www.browsersync.cn/img/sync-demo.gif" alt="" title=""> </div> <div class="image-caption"></div> </figure><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="安装nodejs"><a href="#安装nodejs" class="headerlink" title="安装nodejs"></a>安装nodejs</h4><h4 id="安装browsersync"><a href="#安装browsersync" class="headerlink" title="安装browsersync"></a>安装browsersync</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g browser-sync</div></pre></td></tr></table></figure><h3 id="启动-BrowserSync"><a href="#启动-BrowserSync" class="headerlink" title="启动 BrowserSync"></a>启动 BrowserSync</h3><h4 id="静态网站"><a href="#静态网站" class="headerlink" title="静态网站"></a>静态网站</h4><p>如果您想要监听.css文件, 您需要使用服务器模式。 BrowserSync 将启动一个小型服务器，并提供一个URL来查看您的网站。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">browser-sync start --server --files <span class="string">"css/*.css"</span></div></pre></td></tr></table></figure></p><p><code>--files</code> 路径是相对于运行该命令的项目（目录） </p><p>如果您需要监听多个类型的文件，您只需要用逗号隔开。例如我们再加入一个.html文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># --files 路径是相对于运行该命令的项目（目录） </span></div><div class="line">browser-sync start --server --files <span class="string">"css/*.css, *.html"</span></div><div class="line"><span class="comment"># 如果你的文件层级比较深，您可以考虑使用 **（表示任意目录）匹配，任意目录下任意.css 或 .html文件。 </span></div><div class="line">browser-sync start --server --files <span class="string">"**/*.css, **/*.html"</span></div></pre></td></tr></table></figure><h4 id="动态网站"><a href="#动态网站" class="headerlink" title="动态网站"></a>动态网站</h4><p>如果您已经有其他本地服务器环境PHP或类似的，您需要使用代理模式。 BrowserSync将通过代理URL(localhost:3000)来查看您的网站。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 主机名可以是ip或域名</span></div><div class="line"><span class="comment"># --port 指定代理端口</span></div><div class="line">browser-sync start --proxy <span class="string">"127.0.0.1:8080"</span> --port 3001 --files <span class="string">"css/*.css"</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Browsersync能让浏览器实时、快速响应您的文件更改（html、js、css、sass、less等）并自动刷新页面。&lt;br&gt;更重要的是 Browsersync可以同时在PC、平板、手机等设备下进项调试。&lt;br&gt;您可以想象一下：“假设您的桌子上有pc、ipad、iphone、android等设备，同时打开了您需要调试的页面，当您使用browsersync后，您的任何一次代码保存，以上的设备都会同时显示您的改动”。&lt;br&gt;无论您是前端还是后端工程师，使用它将提高您30%的工作效率。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="自动化" scheme="http://blog.cuiyy.top/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>nodemon</title>
    <link href="http://blog.cuiyy.top/2017/06/20/Ga3g8f89sQ1zEnJ9/"/>
    <id>http://blog.cuiyy.top/2017/06/20/Ga3g8f89sQ1zEnJ9/</id>
    <published>2017-06-20T08:40:13.000Z</published>
    <updated>2017-06-20T11:26:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.npmjs.com/package/nodemon" target="_blank" rel="external">nodemon</a>将监视启动nodemon的目录中的文件，如果任何文件更改，nodemon将自动重新启动node应用程序。</p><p><figure class="image-bubble"> <div class="img-lightbox"> <div class="overlay"></div> <img src="https://ws4.sinaimg.cn/large/006tKfTcly1fgrtvlh5b7j307g08iglq.jpg" alt="" title=""> </div> <div class="image-caption"></div> </figure><br><a id="more"></a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g nodemon</div></pre></td></tr></table></figure><h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nodemon [your node app]</div></pre></td></tr></table></figure><p>使用nodemon很简单，如果我的应用程序接受主机和端口作为参数，可以这样使用:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nodemon ./server.js localhost 8080</div></pre></td></tr></table></figure><p>nodemon还支持运行和监视coffee脚本应用程序：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nodemon server.coffee</div></pre></td></tr></table></figure><p>启用调试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">nodemon --debug ./server.js 80</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.npmjs.com/package/nodemon&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nodemon&lt;/a&gt;将监视启动nodemon的目录中的文件，如果任何文件更改，nodemon将自动重新启动node应用程序。&lt;/p&gt;
&lt;p&gt;&lt;figure class=&quot;image-bubble&quot;&gt; &lt;div class=&quot;img-lightbox&quot;&gt; &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt; &lt;img src=&quot;https://ws4.sinaimg.cn/large/006tKfTcly1fgrtvlh5b7j307g08iglq.jpg&quot; alt=&quot;&quot; title=&quot;&quot;&gt; &lt;/div&gt; &lt;div class=&quot;image-caption&quot;&gt;&lt;/div&gt; &lt;/figure&gt;&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="自动化" scheme="http://blog.cuiyy.top/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>yarn 快速、可靠、安全的依赖管理</title>
    <link href="http://blog.cuiyy.top/2017/06/20/Eyvj2n2bqaRnQFDq/"/>
    <id>http://blog.cuiyy.top/2017/06/20/Eyvj2n2bqaRnQFDq/</id>
    <published>2017-06-20T03:35:25.000Z</published>
    <updated>2017-06-23T03:39:21.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://yarnpkg.com" target="_blank" rel="external">yarn</a>是类似于<code>npm</code>的包管理工具，相比npm,速度更快，更安全可靠。<br><a id="more"></a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://yarnpkg.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;yarn&lt;/a&gt;是类似于&lt;code&gt;npm&lt;/code&gt;的包管理工具，相比npm,速度更快，更安全可靠。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="nodejs" scheme="http://blog.cuiyy.top/tags/nodejs/"/>
    
      <category term="工具" scheme="http://blog.cuiyy.top/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Ubuntu 16 安装mongodb</title>
    <link href="http://blog.cuiyy.top/2017/05/02/gKAfWgqGd2uDqcHZ/"/>
    <id>http://blog.cuiyy.top/2017/05/02/gKAfWgqGd2uDqcHZ/</id>
    <published>2017-05-02T02:58:36.000Z</published>
    <updated>2017-06-20T09:50:35.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="通过apt-get安装"><a href="#通过apt-get安装" class="headerlink" title="通过apt-get安装"></a>通过apt-get安装</h3><h4 id="软件包签名验证"><a href="#软件包签名验证" class="headerlink" title="软件包签名验证"></a>软件包签名验证</h4><p>Ubuntu软件包管理工具（即dpkg和apt）通过要求分销商使用GPG密钥对软件包进行签名来确保软件包的一致性和真实性。<br><a id="more"></a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6</div></pre></td></tr></table></figure></p><p><a href="https://docs.mongodb.com/master/tutorial/install-mongodb-on-ubuntu/?_ga=2.148904432.795010929.1496648330-1138931183.1493269032" target="_blank" rel="external">官方文档</a></p><h4 id="为MongoDB创建一个列表文件"><a href="#为MongoDB创建一个列表文件" class="headerlink" title="为MongoDB创建一个列表文件"></a>为MongoDB创建一个列表文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"deb [ arch=amd64,arm64 ] http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.4 multiverse"</span> | sudo tee /etc/apt/sources.list.d/mongodb-org-3.4.list</div></pre></td></tr></table></figure><h4 id="更新本地包数据"><a href="#更新本地包数据" class="headerlink" title="更新本地包数据"></a>更新本地包数据</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div></pre></td></tr></table></figure><h4 id="安装MongoDB包"><a href="#安装MongoDB包" class="headerlink" title="安装MongoDB包"></a>安装MongoDB包</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install -y mongodb-org</div></pre></td></tr></table></figure><h4 id="启动-暂停-重启"><a href="#启动-暂停-重启" class="headerlink" title="启动|暂停|重启"></a>启动|暂停|重启</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo service mongod start</div><div class="line">sudo service mongod stop</div><div class="line">sudo service mongod restart</div></pre></td></tr></table></figure><h3 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h3><h4 id="下载安装包"><a href="#下载安装包" class="headerlink" title="下载安装包"></a>下载安装包</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">wget https://fastdl.mongodb.org/linux/mongodb-linux-arm64-ubuntu1604-3.4.4.tgz</div></pre></td></tr></table></figure><h4 id="解压"><a href="#解压" class="headerlink" title="解压"></a>解压</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tar -xzvf mongodb-linux-arm64-ubuntu1604-3.4.4.tgz</div></pre></td></tr></table></figure><h4 id="编写Ubuntu服务文件"><a href="#编写Ubuntu服务文件" class="headerlink" title="编写Ubuntu服务文件"></a>编写Ubuntu服务文件</h4><p>增加<code>/lib/systemd/system/mongod.service</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[Unit]</div><div class="line">Description=An object/document-oriented database</div><div class="line">Documentation=man:mongod(1)</div><div class="line"></div><div class="line">[Service]</div><div class="line">User=root</div><div class="line">ExecStart=/mongodb/bin/mongod --quiet --config /mongodb/mongodb.conf</div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target</div></pre></td></tr></table></figure><h4 id="重新加载service文件"><a href="#重新加载service文件" class="headerlink" title="重新加载service文件"></a>重新加载service文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">systemctl daemon-reload</div></pre></td></tr></table></figure><h4 id="启动-暂停-重启-1"><a href="#启动-暂停-重启-1" class="headerlink" title="启动|暂停|重启"></a>启动|暂停|重启</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sudo service mongod start</div><div class="line">sudo service mongod stop</div><div class="line">sudo service mongod restart</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;通过apt-get安装&quot;&gt;&lt;a href=&quot;#通过apt-get安装&quot; class=&quot;headerlink&quot; title=&quot;通过apt-get安装&quot;&gt;&lt;/a&gt;通过apt-get安装&lt;/h3&gt;&lt;h4 id=&quot;软件包签名验证&quot;&gt;&lt;a href=&quot;#软件包签名验证&quot; class=&quot;headerlink&quot; title=&quot;软件包签名验证&quot;&gt;&lt;/a&gt;软件包签名验证&lt;/h4&gt;&lt;p&gt;Ubuntu软件包管理工具（即dpkg和apt）通过要求分销商使用GPG密钥对软件包进行签名来确保软件包的一致性和真实性。&lt;br&gt;
    
    </summary>
    
      <category term="技术" scheme="http://blog.cuiyy.top/categories/%E6%8A%80%E6%9C%AF/"/>
    
    
      <category term="Ubuntu16" scheme="http://blog.cuiyy.top/tags/Ubuntu16/"/>
    
      <category term="mongodb" scheme="http://blog.cuiyy.top/tags/mongodb/"/>
    
  </entry>
  
</feed>
